=== BRM基因RNA-seq数据分析 ===

输入文件: F:\githubclone\BRM_Mitacs\data\processed\working.csv
输出目录: F:\githubclone\BRM_Mitacs\results\brm_analysis_csv
正在加载数据...
成功读取CSV文件
原始数据维度: (20531, 307)
基因数: 20531, 样本数: 307

数据预览 (加载后):
                   TCGA-04-1348-01A-01R-1565-13  ...  TCGA-WR-A838-01A-12R-A406-31
Hybridization REF                                ...                              
?|100130426                              0.0000  ...                        0.0000
?|100133144                             27.3245  ...                      156.2168
?|100134869                             45.8134  ...                      104.8366
?|10357                                 24.0979  ...                       32.6951
?|10431                               1509.2767  ...                     1129.1811

[5 rows x 307 columns]

打印纯数据预览 (无索引, 5x5):
[[0.0000000e+00 0.0000000e+00 6.6190000e-01 0.0000000e+00 0.0000000e+00]
 [2.7324500e+01 2.1966100e+01 2.7261100e+01 1.8606200e+01 1.2999800e+01]
 [4.5813400e+01 3.6627600e+01 5.3161900e+01 1.4467700e+01 9.2994000e+00]
 [2.4097900e+01 9.1146000e+00 3.2103000e+01 3.0249800e+01 6.8546000e+01]
 [1.5092767e+03 6.9661460e+02 1.0564202e+03 1.3725640e+03 1.4581889e+03]]

打印行索引预览 (前5个):
Index(['?|100130426', '?|100133144', '?|100134869', '?|10357', '?|10431'], dtype='object', name='Hybridization REF')

打印列索引预览 (前5个):
Index(['TCGA-04-1348-01A-01R-1565-13', 'TCGA-04-1357-01A-01R-1565-13',
       'TCGA-04-1362-01A-01R-1565-13', 'TCGA-04-1364-01A-01R-1565-13',
       'TCGA-04-1365-01A-01R-1565-13'],
      dtype='object')
清理数据，转换为数值型...
过滤0值占比 > 50%的列（样本）...
删除了 0 个0值占比 > 50%的列
过滤0值占比 > 50%的行（基因）...
删除了 2568 个0值占比 > 50%的行
清理后数据维度: (17963, 307)
警告: 未找到BRM或SMARCA2基因
可能的BRM相关基因: ['BRMS1L|84312', 'BRMS1|25855', 'PBRM1|55193', 'SMARCA2|6595']
选择SMARCA2基因: SMARCA2|6595
为 SMARCA2|6595 表达分布创建可视化图表...
分布图已保存到: F:\githubclone\BRM_Mitacs\results\brm_analysis_csv\SMARCA2_expression_distribution.png
基于 SMARCA2|6595 表达水平创建分组...
低表达组 (<= 40%, 9.886): 123个样本
高表达组 (>= 60%, 10.368): 123个样本
中间组: 61个样本

为下游分析筛选样本，仅保留高低表达组，共 246 个样本。
进行差异表达分析...
处理进度: 0/17963
处理进度: 1000/17963
处理进度: 2000/17963
处理进度: 3000/17963
处理进度: 4000/17963
处理进度: 5000/17963
处理进度: 6000/17963
处理进度: 7000/17963
处理进度: 8000/17963
处理进度: 9000/17963
处理进度: 10000/17963
处理进度: 11000/17963
处理进度: 12000/17963
处理进度: 13000/17963
处理进度: 14000/17963
处理进度: 15000/17963
处理进度: 16000/17963
处理进度: 17000/17963
显著差异基因数: 5928
上调基因数: 3185
下调基因数: 2743
计算与SMARCA2|6595的相关性...
显著正相关基因数: 622
显著负相关基因数: 471
保存分析结果到: F:\githubclone\BRM_Mitacs\results\brm_analysis_csv
结果已保存:
- F:\githubclone\BRM_Mitacs\results\brm_analysis_csv\differential_expression_results.csv
- F:\githubclone\BRM_Mitacs\results\brm_analysis_csv\significant_DEGs.csv
- F:\githubclone\BRM_Mitacs\results\brm_analysis_csv\correlation_analysis_results.csv
- F:\githubclone\BRM_Mitacs\results\brm_analysis_csv\significant_correlations.csv

=== 分析总结 ===
分析基因: SMARCA2|6595
总基因数: 17963
总样本数: 246
显著差异基因数: 5928
显著相关基因数: 1093

Top 10 显著差异表达基因 (按padj排序):
  CFH|3075: log2FC=1.435, padj=1.32e-11
  C18orf1|753: log2FC=1.038, padj=3.69e-11
  KIAA2026|158358: log2FC=0.644, padj=6.10e-11
  TARBP2|6895: log2FC=-0.556, padj=1.82e-10
  DENND4C|55667: log2FC=0.588, padj=4.63e-10
  LOC92973|92973: log2FC=1.106, padj=1.60e-09
  VLDLR|7436: log2FC=0.922, padj=1.60e-09
  ENTPD3|956: log2FC=1.456, padj=4.06e-09
  STARD13|90627: log2FC=0.737, padj=4.06e-09
  ZCCHC6|79670: log2FC=0.513, padj=4.19e-09

Top 10 显著相关基因 (按padj排序):
  CFH|3075: rho=0.563, padj=5.31e-18
  C18orf1|753: rho=0.525, padj=4.56e-15
  VLDLR|7436: rho=0.519, padj=1.03e-14
  KIAA2026|158358: rho=0.513, padj=2.43e-14
  DENND4C|55667: rho=0.501, padj=1.58e-13
  ZCCHC6|79670: rho=0.498, padj=1.93e-13
  TARBP2|6895: rho=-0.497, padj=2.15e-13
  STARD13|90627: rho=0.494, padj=3.04e-13
  NRP2|8828: rho=0.489, padj=6.32e-13
  SFMBT2|57713: rho=0.487, padj=7.32e-13

=== 统计信息 ===
总p值 < 0.05的基因数: 7754
FDR校正后 < 0.05的基因数: 5929
|log2FC| > 1的基因数: 240
|log2FC| > 2的基因数: 5
总相关性p值 < 0.05的基因数: 8611
相关性FDR校正后 < 0.05的基因数: 7203
|rho| > 0.3的基因数: 1094
|rho| > 0.5的基因数: 6
